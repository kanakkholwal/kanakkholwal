---
title: 'Mailer System'
description: 'An extendable serverless mailing system with Nextjs and React mail'
author: 'Kanak Kholwal'
keywords: ['mail', 'nextjs', 'react-mail']
---

## Overview

The **Mail System** template provides an extendable, serverless mailing system built with Next.js, TypeScript, and React Mail. It allows you to quickly integrate email sending capabilities into your Next.js application using a zero-config API and customizable email templates.


# Mail System

A modern, type-safe email service built with Next.js, React Email, and Nodemailer. This FOSS (Free and Open Source Software) project provides a robust API for sending transactional emails with beautiful, customizable templates.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)


## âœ¨ Features

- **ğŸ¨ Beautiful Email Templates**: Pre-built, responsive email templates using React Email components
- **ğŸ”’ Type-Safe**: Full TypeScript support with Zod schema validation
- **ğŸ“ Template Registry**: Centralized template management system
- **âš¡ Fast & Modern**: Built on Next.js 15 with React 19
- **ğŸ” Secure**: Built-in security with server identity verification
- **ğŸ¯ Flexible**: Easy to customize and extend with new templates
- **ğŸ“¦ Production Ready**: Includes error handling, validation, and logging

## ğŸ“‹ Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js**: Version 18.x or higher
- **npm**, **yarn**, or **pnpm**: Package manager (pnpm recommended)
- **SMTP Server**: Access to an SMTP server (e.g., Gmail, SendGrid, Sendinblue)

## ğŸš€ Quick Start

### 1. Clone the Repository

```bash
git clone https://github.com/kanakkholwal/mail-system.git
cd mail-system
```

### 2. Install Dependencies

```bash
npm install
# or
yarn install
# or
pnpm install
```

### 3. Configure Environment Variables

Copy the example environment file and configure your settings:

```shell
cp .env.example .env
```

Edit `.env` with your SMTP credentials:

```shell
# SMTP Configuration
MAIL_EMAIL=your-email@example.com
MAIL_PASSWORD=your-smtp-password
SMTP_HOST=smtp-relay.sendinblue.com

# Security
SERVER_IDENTITY=your-secure-random-key

# Optional
NODE_ENV=development
```

### 4. Run the Development Server

```bash
npm run dev
```

The server will start at `http://localhost:3000`

## ğŸ”§ Configuration

### Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `MAIL_EMAIL` | âœ… | `noreply@nexonauts.com` | SMTP email address |
| `MAIL_PASSWORD` | âœ… | - | SMTP password/app password |
| `SMTP_HOST` | âŒ | `smtp-relay.sendinblue.com` | SMTP server host |
| `SERVER_IDENTITY` | âœ… | - | Security key for API authentication |
| `NODE_ENV` | âŒ | `development` | Environment mode |

### SMTP Configuration

The system supports any SMTP provider. Common configurations:

**Gmail:**
```shell
SMTP_HOST=smtp.gmail.com
MAIL_EMAIL=your-email@gmail.com
MAIL_PASSWORD=your-app-password
```

**SendGrid:**
```shell
SMTP_HOST=smtp.sendgrid.net
MAIL_EMAIL=apikey
MAIL_PASSWORD=your-sendgrid-api-key
```

**Sendinblue (Brevo):**
```shell
SMTP_HOST=smtp-relay.sendinblue.com
MAIL_EMAIL=your-email@example.com
MAIL_PASSWORD=your-smtp-key
```

## ğŸ“¨ API Usage

### Send Email Endpoint

**Endpoint:** `POST /api/send`

**Request Body:**

```json
{
  "template_key": "welcome_verify",
  "targets": ["user@example.com"],
  "subject": "Welcome to Our Platform!",
  "payload": {
    "name": "John Doe",
    "email": "user@example.com",
    "verificationUrl": "https://example.com/verify?token=abc123"
  }
}
```

**Response (Success):**

```json
{
  "data": ["user@example.com"]
}
```

**Response (Error):**

```json
{
  "error": "Template Validation Failed",
  "message": "Invalid payload for template"
}
```

### Example cURL Request

```bash
curl -X POST http://localhost:3000/api/send \
  -H "Content-Type: application/json" \
  -d '{
    "template_key": "welcome_verify",
    "targets": ["user@example.com"],
    "subject": "Welcome!",
    "payload": {
      "name": "John Doe",
      "email": "user@example.com",
      "verificationUrl": "https://example.com/verify?token=abc123"
    }
  }'
```

### Example JavaScript/Node.js Request

```javascript
const response = await fetch('http://localhost:3000/api/send', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    template_key: 'welcome_verify',
    targets: ['user@example.com'],
    subject: 'Welcome to Our Platform!',
    payload: {
      name: 'John Doe',
      email: 'user@example.com',
      verificationUrl: 'https://example.com/verify?token=abc123'
    }
  })
});

const result = await response.json();
console.log(result);
```

## ğŸ“§ Available Email Templates

### 1. Welcome & Verification Email (`welcome_verify`)

**Purpose:** Welcome new users and verify their email address.

**Required Payload:**

```typescript
{
  name: string;              // User's name
  email: string;             // User's email address
  verificationUrl: string;   // URL for email verification
  branding?: {               // Optional branding override
    name?: string;
    logoUrl?: string;
    websiteUrl?: string;
    primaryColor?: string;
  }
}
```

### 2. Password Reset Email (`reset_password`)

**Purpose:** Send password reset instructions to users.

**Required Payload:**

```typescript
{
  name: string;              // User's name
  email: string;             // User's email address
  resetUrl: string;          // URL for password reset
  branding?: {               // Optional branding override
    name?: string;
    logoUrl?: string;
    websiteUrl?: string;
    primaryColor?: string;
  }
}
```

## ğŸ¨ Creating Custom Templates

### Step 1: Create Template Component

Create a new directory in `emails/templates/`:

```bash
mkdir emails/templates/my-template
```

Create `index.tsx`:

```tsx
import { Button } from "@emails/kit/components/button";
import { Layout } from "@emails/kit/components/layout";
import { H1, BodyText } from "@emails/kit/components/typography";
import { Section } from "@react-email/components";
import { MyTemplateProps } from "./schema";

export const MyTemplate = ({ name, actionUrl }: MyTemplateProps) => {
  return (
    <Layout previewText="Your custom email">
      <Section className="my-6">
        <H1>Hello {name}!</H1>
        <BodyText>This is your custom email template.</BodyText>
        <Button href={actionUrl}>Take Action</Button>
      </Section>
    </Layout>
  );
};

export default MyTemplate;
```

### Step 2: Define Schema

Create `schema.ts`:

```tsx
import { z } from "zod";

export const myTemplateSchema = z.object({
  name: z.string(),
  actionUrl: z.string().url(),
});

export type MyTemplateProps = z.infer<typeof myTemplateSchema>;
```

### Step 3: Register Template

Update `emails/registry.ts`:

```tsx
import MyTemplate from "./templates/my-template";
import { myTemplateSchema } from "./templates/my-template/schema";

export const registry = {
  // ... existing templates
  "my_template": {
    component: MyTemplate,
    schema: myTemplateSchema,
  },
} as const;
```

### Step 4: Use Your Template

```bash
curl -X POST http://localhost:3000/api/send \
  -H "Content-Type: application/json" \
  -d '{
    "template_key": "my_template",
    "targets": ["user@example.com"],
    "subject": "Custom Email",
    "payload": {
      "name": "John",
      "actionUrl": "https://example.com/action"
    }
  }'
```

## ğŸ—ï¸ Project Structure

```
mail-system/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ send/
â”‚   â”‚       â””â”€â”€ route.ts          # Email sending API endpoint
â”‚   â””â”€â”€ layout.tsx                # Root layout
â”œâ”€â”€ emails/
â”‚   â”œâ”€â”€ kit/                      # Reusable email components
â”‚   â”‚   â”œâ”€â”€ components/           # Button, Header, Footer, etc.
â”‚   â”‚   â”œâ”€â”€ tailwind.ts           # Tailwind configuration
â”‚   â”‚   â”œâ”€â”€ tokens.ts             # Design tokens
â”‚   â”‚   â””â”€â”€ types.ts              # TypeScript types
â”‚   â”œâ”€â”€ templates/                # Email templates
â”‚   â”‚   â”œâ”€â”€ welcome-verify/
â”‚   â”‚   â””â”€â”€ reset-password/
â”‚   â”œâ”€â”€ helper.ts                 # Email sending helper functions
â”‚   â”œâ”€â”€ registry.ts               # Template registry
â”‚   â”œâ”€â”€ renderer.tsx              # Template renderer
â”‚   â””â”€â”€ schema.ts                 # Zod schemas
â”œâ”€â”€ .env.example                  # Example environment variables
â”œâ”€â”€ next.config.ts                # Next.js configuration
â”œâ”€â”€ package.json                  # Dependencies and scripts
â”œâ”€â”€ project.config.ts             # Project configuration
â”œâ”€â”€ tsconfig.json                 # TypeScript configuration
â””â”€â”€ README.md                     # This file
```

## ğŸ› ï¸ Development

### Available Scripts

```bash
# Start development server
npm run dev

# Build for production
npm run build

# Start production server
npm run start

# Lint code
npm run lint

# Format code
npm run format
```

### Code Style

This project uses:
- **TypeScript** for type safety
- **Zod** for runtime validation
- **Prettier** for code formatting
- **ESLint** for code linting

### Adding New Features

1. Create a new branch: `git checkout -b feature/your-feature`
2. Make your changes
3. Run linting: `npm run lint`
4. Format code: `npm run format`
5. Test your changes thoroughly
6. Commit with clear messages
7. Push and create a Pull Request

## ğŸ¤ Contributing

Contributions are welcome! Here's how you can help:

### Reporting Bugs

1. Check if the bug has already been reported
2. Create a new issue with a clear title and description
3. Include steps to reproduce
4. Add relevant logs or screenshots

### Suggesting Enhancements

1. Open an issue describing the enhancement
2. Explain why this enhancement would be useful
3. Provide examples if possible

### Pull Requests

1. Fork the repository
2. Create your feature branch
3. Make your changes following our coding standards
4. Add or update tests if needed
5. Ensure all tests pass
6. Update documentation as needed
7. Submit a pull request

### Code of Conduct

- Be respectful and inclusive
- Provide constructive feedback
- Focus on what's best for the community
- Show empathy towards other contributors

## ğŸ› Troubleshooting

### Common Issues

**Issue: "SMTP Authentication Failed"**
- Verify your SMTP credentials are correct
- For Gmail, ensure you're using an App Password, not your regular password
- Check if 2FA is enabled on your email account

**Issue: "Template not found in registry"**
- Verify the template_key matches exactly with registry keys
- Check the spelling and case sensitivity
- Ensure the template is properly registered in `emails/registry.ts`

**Issue: "Invalid payload for template"**
- Check that all required fields are provided
- Verify field types match the schema
- Review the Zod validation error messages in the response

**Issue: "Port 3000 already in use"**
- Kill the process using port 3000: `lsof -ti:3000 | xargs kill -9`
- Or use a different port: `PORT=3001 npm run dev`

### Getting Help

- ğŸ“– Check the [documentation](https://nexonauts.mintlify.app/templates/mail-system)
- ğŸ’¬ Open an issue on GitHub
- ğŸ“§ Contact the maintainers

## ğŸ“š Additional Resources

- [Next.js Documentation](https://nextjs.org/docs)
- [React Email Documentation](https://react.email/docs/introduction)
- [Nodemailer Documentation](https://nodemailer.com/)
- [Zod Documentation](https://zod.dev/)

## Contributing

1. **Fork** the [repository](https://github.com/kanakkholwal/mail-system).
2. **Create** a new branch: `git checkout -b feature/my-feature`.
3. **Commit** your changes: `git commit -m 'Add my feature'`.
4. **Push** to the branch: `git push origin feature/my-feature`.
5. **Open** a Pull Request.

## License

This project is licensed under the [MIT License](https://opensource.org/licenses/MIT).

---

## Support

For issues and suggestions, please visit the [GitHub issues page](https://github.com/kanakkholwal/mail-system/issues).